<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 3: Framing Density - War Room Academy</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --background: #f8fafc;
            --card-bg: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--background);
            color: #1e293b;
            line-height: 1.7;
            font-size: 1.1rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        @media (min-width: 768px) {
            .container {
                padding: 3rem;
            }
        }

        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 3rem 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            text-align: center;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .hero p {
            font-size: 1.2rem;
            opacity: 0.95;
            margin-bottom: 1rem;
        }

        .progress-indicator {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: var(--primary);
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            font-weight: 700;
        }

        h3 {
            color: #334155;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            font-size: 1.3rem;
            font-weight: 600;
        }

        p {
            margin-bottom: 1rem;
        }

        ul {
            margin-bottom: 1.5rem;
            padding-left: 0;
            list-style: none;
        }

        li {
            padding-left: 1.5rem;
            position: relative;
            margin-bottom: 0.75rem;
        }

        li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: var(--primary);
            font-weight: bold;
        }

        .prompt-box {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            margin-bottom: 1rem;
            position: relative;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .copy-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .copy-button:hover {
            background: var(--primary-dark);
        }

        .copy-button.copied {
            background: var(--success);
        }

        textarea {
            width: 100%;
            min-height: 120px;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            margin-bottom: 1rem;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        button:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        button:disabled {
            background: var(--secondary);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .ai-response {
            background: #f1f5f9;
            border-left: 4px solid var(--primary);
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1rem;
            display: none;
        }

        .ai-response.loading {
            display: block;
        }

        .ai-response.visible {
            display: block;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(37, 99, 235, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .char-counter {
            text-align: right;
            font-size: 0.9rem;
            color: var(--secondary);
            margin-top: 0.5rem;
        }

        .char-counter.valid {
            color: var(--success);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 3rem;
            gap: 1rem;
        }

        .nav-button {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .nav-button.back {
            background: white;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .nav-button.back:hover {
            background: var(--primary);
            color: white;
        }

        .nav-button.next {
            background: var(--primary);
            color: white;
        }

        .nav-button.next:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .nav-button:disabled {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid var(--warning);
            padding: 1rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .warning-box strong {
            color: #92400e;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="hero">
            <h1>Lesson 3: Framing Density</h1>
            <p>The 4 mandatory layers that prevent drift</p>
            <div class="progress-indicator">Module 1 • Lesson 3 of 4</div>
        </div>

        <div class="card">
            <h2>The Problem With Thin Framing</h2>
            <p>Most prompts fail because they lack density. Thin framing produces vague, generic, inspirational output. The AI drifts into safe patterns because you gave it no operational constraints. Dense framing locks the system into your reality.</p>

            <p>Framing Density is not about being detailed. It's about including the 4 mandatory layers that force the AI to operate within your constraints instead of hallucinating ideal scenarios.</p>

            <h3>The 4 Mandatory Layers</h3>
            <p>Every War Room prompt requires these layers. Missing even one causes drift:</p>

            <ul>
                <li><strong>Identity:</strong> Who you are + what failure costs you. Not your title—your operational reality. "Founder with 3 months runway" not "entrepreneur."</li>
                <li><strong>Constraints:</strong> Time, budget, energy, skill ceiling. Real limits, not aspirations. "2 hours per day, $500 budget, no coding skill" not "limited resources."</li>
                <li><strong>Format:</strong> Structure, length, inclusion requirements. "3 options, one sentence each, include cost estimate" not "give me some ideas."</li>
                <li><strong>Verification:</strong> How you'll test if output works. "Will ship to 10 customers Monday" not "sounds good" or "makes sense."</li>
            </ul>

            <h3>Stop Conditions</h3>
            <p>You know framing is too thin when the output contains:</p>
            <ul>
                <li>Motivational language ("exciting opportunity," "best practices")</li>
                <li>Theory without execution steps</li>
                <li>Options you can't actually execute</li>
                <li>No mention of your specific constraints</li>
            </ul>

            <div class="warning-box">
                <strong>War Room Rule:</strong> If the output could apply to anyone, your framing was too thin. Dense framing produces output only you can use.
            </div>
        </div>

        <div class="card">
            <h2>Interactive Exercise</h2>
            <p>Here's a prompt with all 4 density layers. Copy it and test it with the AI, then modify it for your own scenario:</p>

            <div class="prompt-box" id="promptBox">I'm a SaaS founder with 3 months of runway left (Identity). I have 10 hours this week, $1000 budget, and can't code (Constraints). Give me 3 customer acquisition tactics, one sentence each, with estimated cost per customer (Format). I will test the top option with 20 outreach attempts by Friday (Verification).</div>
            <button class="copy-button" onclick="copyPrompt()">Copy Prompt</button>

            <h3>Try It Yourself</h3>
            <textarea id="chatInput" placeholder="Paste the prompt here or write your own..."></textarea>
            <button onclick="sendToAI()">Send to AI</button>

            <div id="aiResponse" class="ai-response"></div>
        </div>

        <div class="card">
            <h2>Checkpoint</h2>
            <p><strong>Write a dense frame for YOUR current biggest problem. Include all 4 layers: Identity, Constraints, Format, and Verification.</strong></p>
            <p>This forces you to apply framing density to something real. If you can't write verification, you're not ready to execute.</p>

            <textarea id="checkpointAnswer" placeholder="Example: I'm a freelance designer with 2 active clients (Identity). I have 5 hours per week for business development, no ad budget, scared of cold outreach (Constraints). Give me 2 client acquisition methods, bullet points, with time investment per lead (Format). I will execute the top method with 5 attempts this week (Verification)."></textarea>
            <div class="char-counter" id="charCounter">0 / 20 characters minimum</div>
            <button id="continueBtn" onclick="completeLesson()" disabled>Continue to Lesson 4 →</button>
        </div>

        <div class="navigation">
            <a href="index.html" class="nav-button back">← Back to Module 1</a>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Check lesson access
        checkAccess(3);

        // Copy prompt functionality
        function copyPrompt() {
            const promptText = document.getElementById('promptBox').textContent;
            navigator.clipboard.writeText(promptText);

            const button = document.querySelector('.copy-button');
            button.textContent = 'Copied!';
            button.classList.add('copied');

            document.getElementById('chatInput').value = promptText;

            setTimeout(() => {
                button.textContent = 'Copy Prompt';
                button.classList.remove('copied');
            }, 2000);
        }

        // Send to AI functionality
        async function sendToAI() {
            const input = document.getElementById('chatInput').value.trim();
            const responseDiv = document.getElementById('aiResponse');

            if (!input) {
                alert('Please enter a prompt first');
                return;
            }

            responseDiv.className = 'ai-response loading';
            responseDiv.innerHTML = '<div class="loading-spinner"></div> AI is thinking...';

            try {
                const response = await fetch(CONFIG.WORKER_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: input
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    responseDiv.className = 'ai-response visible';
                    responseDiv.innerHTML = `<strong>AI Response:</strong><br><br>${data.response}`;
                } else {
                    responseDiv.className = 'ai-response visible';
                    responseDiv.innerHTML = `<strong>Error:</strong> ${data.error || 'Failed to get response'}`;
                }
            } catch (error) {
                responseDiv.className = 'ai-response visible';
                responseDiv.innerHTML = `<strong>Error:</strong> ${error.message}`;
            }
        }

        // Checkpoint validation
        const checkpointAnswer = document.getElementById('checkpointAnswer');
        const charCounter = document.getElementById('charCounter');
        const continueBtn = document.getElementById('continueBtn');

        checkpointAnswer.addEventListener('input', function() {
            const length = this.value.trim().length;
            charCounter.textContent = `${length} / 20 characters minimum`;

            if (length >= 20) {
                charCounter.classList.add('valid');
                continueBtn.disabled = false;
            } else {
                charCounter.classList.remove('valid');
                continueBtn.disabled = true;
            }
        });

        function completeLesson() {
            const answer = checkpointAnswer.value.trim();

            if (answer.length >= 20) {
                // Save answer to localStorage
                const answers = JSON.parse(localStorage.getItem('warRoomAnswers') || '{}');
                answers.lesson3 = answer;
                localStorage.setItem('warRoomAnswers', JSON.stringify(answers));

                // Mark lesson complete
                saveProgress(3);

                // Redirect to next lesson
                window.location.href = 'lesson-4.html';
            }
        }

        // Load saved answer if exists
        window.addEventListener('DOMContentLoaded', function() {
            const answers = JSON.parse(localStorage.getItem('warRoomAnswers') || '{}');
            if (answers.lesson3) {
                checkpointAnswer.value = answers.lesson3;
                checkpointAnswer.dispatchEvent(new Event('input'));
            }
        });
    </script>
</body>
</html>